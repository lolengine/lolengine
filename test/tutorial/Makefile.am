
AM_CPPFLAGS = -I$(top_srcdir)/src

all-local: $(noinst_PROGRAMS)
	for x in $(noinst_PROGRAMS:%$(EXEEXT)=%); do \
	  test x$(MAKE_FSELF) = xno || make_fself $${x}$(EXEEXT) $${x}.self; \
	done

CLEANFILES = $(noinst_PROGRAMS:%$(EXEEXT)=%.self) \
             $(noinst_PROGRAMS:%$(EXEEXT)=%.elf) \
             $(noinst_PROGRAMS:%$(EXEEXT)=%.exe)

SUFFIXES = .lolfx
%.lolfx.cpp: %.lolfx
	echo "/* This file was autogenerated. DO NOT MODIFY IT. */" > $@.tmp
	echo "char const *lolfx_$(notdir $(^:%.lolfx=%)) =" >> $@.tmp
	$(SED) 's/"/\\"/g' $^ | $(SED) 's/.*/"&\\n"/' >> $@.tmp
	echo ";" >> $@.tmp
	mv $@.tmp $@

noinst_PROGRAMS = 01_triangle 02_cube 03_fractal

01_triangle_SOURCES = 01_triangle.cpp
nodist_01_triangle_SOURCES = 01_triangle.lolfx.cpp
01_triangle_CPPFLAGS = @LOL_CFLAGS@ @PIPI_CFLAGS@
01_triangle_LDFLAGS = $(top_builddir)/src/liblol.a @LOL_LIBS@ @PIPI_LIBS@
01_triangle_DEPENDENCIES = $(top_builddir)/src/liblol.a

02_cube_SOURCES = 02_cube.cpp
nodist_02_cube_SOURCES = 02_cube.lolfx.cpp
02_cube_CPPFLAGS = @LOL_CFLAGS@ @PIPI_CFLAGS@
02_cube_LDFLAGS = $(top_builddir)/src/liblol.a @LOL_LIBS@ @PIPI_LIBS@
02_cube_DEPENDENCIES = $(top_builddir)/src/liblol.a

03_fractal_SOURCES = 03_fractal.cpp
nodist_03_fractal_SOURCES = 03_fractal.lolfx.cpp
03_fractal_CPPFLAGS = @LOL_CFLAGS@ @PIPI_CFLAGS@
03_fractal_LDFLAGS = $(top_builddir)/src/liblol.a @LOL_LIBS@ @PIPI_LIBS@
03_fractal_DEPENDENCIES = $(top_builddir)/src/liblol.a

